rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
view(datamb)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_metb <- datamb %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## Metformin prep(Cohort B)
datamb <- read_excel('Data/PK/Metformin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
metb <- datamb %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
view(datamb)
view(datamb)
new_metb <- datamb %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
library(tidyverse)
library(readxl)
library(zoo)
library(NonCompart)
library(gtsummary)
library(sasLM)
library(nlme)
my_theme <-
list(
# round large p-values to two places
"pkgwide-fn:pvalue_fun" = function(x) style_pvalue(x, digits = 2),
"pkgwide-fn:prependpvalue_fun" = function(x) style_pvalue(x, digits = 2, prepend_p = TRUE),
# report median (IQR) and n (percent) as default stats in `tbl_summary()`
"tbl_summary-str:continuous_stat" = "{mean} ± {sd}",
"tbl_summary-str:categorical_stat" = "{n} ({p}%)"
)
set_gtsummary_theme(my_theme)
theme_gtsummary_compact()
## Metformin B prep
datamb <- read_excel('Data/PK/Dapagliflozin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
metb <- datamb %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
db <- list.files('Data/DB', pattern = "xlsx", full.names = T)
db_rn <- read_excel(db, sheet = "RN")
db_pk <- read_excel(db, sheet = "PB")
db_rn
view(metb)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_metb <- metb %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
metb_NCA <- tblNCA(new_metb, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 10, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
metb_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmbc <- LCMAX ~ Period  # LCMAX
BEmbc <- lme(fmbc, random = ~1|ID, data = metb_BE_raw)
cimbc <- intervals(BEmbc, 0.9)
exp(cimbc$fixed["Period2기", ])    ## 90% CI result
GLM(fmbc, metb_BE_raw)$ANOVA     ## Anova result
## Comparative PK(AUCLST)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmba <- LAUCLST ~ Period  # LAUCLST
BEmba <- lme(fmba, random = ~1|ID, data = metb_BE_raw)
cimba <- intervals(BEmba, 0.9)
exp(cimba$fixed["Period2기", ])    ## 90% CI result
GLM(fmba, metb_BE_raw)$ANOVA     ## Anova result
library(tidyverse)
library(readxl)
library(zoo)
library(NonCompart)
library(gtsummary)
library(sasLM)
library(nlme)
my_theme <-
list(
# round large p-values to two places
"pkgwide-fn:pvalue_fun" = function(x) style_pvalue(x, digits = 2),
"pkgwide-fn:prependpvalue_fun" = function(x) style_pvalue(x, digits = 2, prepend_p = TRUE),
# report median (IQR) and n (percent) as default stats in `tbl_summary()`
"tbl_summary-str:continuous_stat" = "{mean} ± {sd}",
"tbl_summary-str:categorical_stat" = "{n} ({p}%)"
)
set_gtsummary_theme(my_theme)
theme_gtsummary_compact()
## Metformin B prep
datamb <- read_excel('Data/PK/metformin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
metb <- datamb %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
db <- list.files('Data/DB', pattern = "xlsx", full.names = T)
db_rn <- read_excel(db, sheet = "RN")
db_pk <- read_excel(db, sheet = "PB")
db_rn
view(metb)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_metb <- metb %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
metb_NCA <- tblNCA(new_metb, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 10, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
metb_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmbc <- LCMAX ~ Period  # LCMAX
BEmbc <- lme(fmbc, random = ~1|ID, data = metb_BE_raw)
cimbc <- intervals(BEmbc, 0.9)
exp(cimbc$fixed["Period2기", ])    ## 90% CI result
GLM(fmbc, metb_BE_raw)$ANOVA     ## Anova result
## Comparative PK(AUCLST)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmba <- LAUCLST ~ Period  # LAUCLST
BEmba <- lme(fmba, random = ~1|ID, data = metb_BE_raw)
cimba <- intervals(BEmba, 0.9)
exp(cimba$fixed["Period2기", ])    ## 90% CI result
GLM(fmba, metb_BE_raw)$ANOVA     ## Anova result
library(tidyverse)
library(readxl)
library(zoo)
library(NonCompart)
library(gtsummary)
library(sasLM)
library(nlme)
my_theme <-
list(
# round large p-values to two places
"pkgwide-fn:pvalue_fun" = function(x) style_pvalue(x, digits = 2),
"pkgwide-fn:prependpvalue_fun" = function(x) style_pvalue(x, digits = 2, prepend_p = TRUE),
# report median (IQR) and n (percent) as default stats in `tbl_summary()`
"tbl_summary-str:continuous_stat" = "{mean} ± {sd}",
"tbl_summary-str:categorical_stat" = "{n} ({p}%)"
)
set_gtsummary_theme(my_theme)
theme_gtsummary_compact()
## Metformin B prep
datamb <- read_excel('Data/PK/metformin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
metb <- datamb %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
db <- list.files('Data/DB', pattern = "xlsx", full.names = T)
db_rn <- read_excel(db, sheet = "RN")
db_pk <- read_excel(db, sheet = "PB")
db_rn
view(metb)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_metb <- metb %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
metb_NCA <- tblNCA(new_metb, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 10, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
metb_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmbc <- LCMAX ~ Period  # LCMAX
BEmbc <- lme(fmbc, random = ~1|ID, data = metb_BE_raw)
cimbc <- intervals(BEmbc, 0.9)
exp(cimbc$fixed["Period2기", ])    ## 90% CI result
GLM(fmbc, metb_BE_raw)$ANOVA     ## Anova result
## Comparative PK(AUCLST)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmba <- LAUCLST ~ Period  # LAUCLST
BEmba <- lme(fmba, random = ~1|ID, data = metb_BE_raw)
cimba <- intervals(BEmba, 0.9)
exp(cimba$fixed["Period2기", ])    ## 90% CI result
GLM(fmba, metb_BE_raw)$ANOVA     ## Anova result
library(tidyverse)
library(readxl)
library(zoo)
library(NonCompart)
library(gtsummary)
library(sasLM)
library(nlme)
my_theme <-
list(
# round large p-values to two places
"pkgwide-fn:pvalue_fun" = function(x) style_pvalue(x, digits = 2),
"pkgwide-fn:prependpvalue_fun" = function(x) style_pvalue(x, digits = 2, prepend_p = TRUE),
# report median (IQR) and n (percent) as default stats in `tbl_summary()`
"tbl_summary-str:continuous_stat" = "{mean} ± {sd}",
"tbl_summary-str:categorical_stat" = "{n} ({p}%)"
)
set_gtsummary_theme(my_theme)
theme_gtsummary_compact()
## Dapa prep
datad <- read_excel('Data/PK/Dapagliflozin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
dapa <- datad %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
db <- list.files('Data/DB', pattern = "xlsx", full.names = T)
db_rn <- read_excel(db, sheet = "RN")
db_pk <- read_excel(db, sheet = "PB")
db_rn
view(dapa)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_dapa <- dapa %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
dapa_NCA <- tblNCA(new_dapa, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 10, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
dapa_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
dapa_BE_raw <- dapa_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fc <- LCMAX ~ Period  # LCMAX
BEdc <- lme(fc, random = ~1|ID, data = dapa_BE_raw)
cidc <- intervals(BEdc, 0.9)
exp(cidc$fixed["Period2기", ])    ## 90% CI result
GLM(fc, dapa_BE_raw)$ANOVA     ## Anova result
## Comparative PK(AUCLST)
dapa_BE_raw <- dapa_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fa <- LAUCLST ~ Period  # LAUCLST
BEda <- lme(fa, random = ~1|ID, data = dapa_BE_raw)
cida <- intervals(BEda, 0.9)
exp(cida$fixed["Period2기", ])    ## 90% CI result
GLM(fa, dapa_BE_raw)$ANOVA     ## Anova result
## Metformin prep(Cohort B)
datamb <- read_excel('Data/PK/metformin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
metb <- datamb %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
view(metb)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_metb <- metb %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
metb_NCA <- tblNCA(new_metb, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 10, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
metb_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmbc <- LCMAX ~ Period  # LCMAX
BEmbc <- lme(fmbc, random = ~1|ID, data = metb_BE_raw)
cimbc <- intervals(BEmbc, 0.9)
exp(cimbc$fixed["Period2기", ])    ## 90% CI result
GLM(fmbc, metb_BE_raw)$ANOVA     ## Anova result
library(tidyverse)
library(readxl)
library(zoo)
library(NonCompart)
library(gtsummary)
library(sasLM)
library(nlme)
my_theme <-
list(
# round large p-values to two places
"pkgwide-fn:pvalue_fun" = function(x) style_pvalue(x, digits = 2),
"pkgwide-fn:prependpvalue_fun" = function(x) style_pvalue(x, digits = 2, prepend_p = TRUE),
# report median (IQR) and n (percent) as default stats in `tbl_summary()`
"tbl_summary-str:continuous_stat" = "{mean} ± {sd}",
"tbl_summary-str:categorical_stat" = "{n} ({p}%)"
)
set_gtsummary_theme(my_theme)
theme_gtsummary_compact()
## Dapa prep
datad <- read_excel('Data/PK/Dapagliflozin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
dapa <- datad %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
db <- list.files('Data/DB', pattern = "xlsx", full.names = T)
db_rn <- read_excel(db, sheet = "RN")
db_pk <- read_excel(db, sheet = "PB")
db_rn
view(dapa)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_dapa <- dapa %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
dapa_NCA <- tblNCA(new_dapa, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 10, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
dapa_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
dapa_BE_raw <- dapa_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fc <- LCMAX ~ Period  # LCMAX
BEdc <- lme(fc, random = ~1|ID, data = dapa_BE_raw)
cidc <- intervals(BEdc, 0.9)
exp(cidc$fixed["Period2기", ])    ## 90% CI result
GLM(fc, dapa_BE_raw)$ANOVA     ## Anova result
## Comparative PK(AUCLST)
dapa_BE_raw <- dapa_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fa <- LAUCLST ~ Period  # LAUCLST
BEda <- lme(fa, random = ~1|ID, data = dapa_BE_raw)
cida <- intervals(BEda, 0.9)
exp(cida$fixed["Period2기", ])    ## 90% CI result
GLM(fa, dapa_BE_raw)$ANOVA     ## Anova result
## Metformin prep(Cohort B)
datamb <- read_excel('Data/PK/metformin.xlsx', sheet = 5, skip = 1)
"%ni%" <- Negate("%in%")
metb <- datamb %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("B140", "B070")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
view(metb)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_metb <- metb %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
metb_NCA <- tblNCA(new_metb, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 1000, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
metb_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmbc <- LCMAX ~ Period  # LCMAX
BEmbc <- lme(fmbc, random = ~1|ID, data = metb_BE_raw)
cimbc <- intervals(BEmbc, 0.9)
exp(cimbc$fixed["Period2기", ])    ## 90% CI result
GLM(fmbc, metb_BE_raw)$ANOVA     ## Anova result
## Comparative PK(AUCLST)
metb_BE_raw <- metb_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmba <- LAUCLST ~ Period  # LAUCLST
BEmba <- lme(fmba, random = ~1|ID, data = metb_BE_raw)
cimba <- intervals(BEmba, 0.9)
exp(cimba$fixed["Period2기", ])    ## 90% CI result
GLM(fmba, metb_BE_raw)$ANOVA     ## Anova result
## Metformin prep(Cohort C)
datamc <- read_excel('Data/PK/Metformin.xlsx', sheet = 6, skip = 1)
"%ni%" <- Negate("%in%")
metc <- datamc %>%
mutate(Period = ifelse(is.na(Period), na.locf(Period), Period)) %>%
rename("Time" = 2) %>%
gather("ID", "Conc", -c("Period", "Time")) %>%
mutate(Conc = as.numeric(Conc)) %>%
filter(ID %ni% c("C040", "C190", "C230")) %>%
as.data.frame()
# DB 수령 후 Real-time 적용 예정
view(metc)
db_pk_tidy <- db_pk %>%
mutate(PBDETM = ifelse(SEQ == 1, 0, PBDETM), PBDETM = as.numeric(PBDETM)) %>%
left_join(db_rn %>% select(SUBJID, RNNO), by = "SUBJID") %>%
rename(ID = RNNO) %>%
mutate(Period = ifelse(VISIT %in% c(3, 4), "1기", "2기")) %>%
mutate(Time = parse_number(PBNT))
new_metc <- metc %>%
left_join(db_pk_tidy %>% select(ID, Time, PBDETM, Period), by = c("ID", "Period", "Time")) %>%
mutate(RTime = Time + PBDETM/60) %>%
arrange(ID)
## NCA calculation
metc_NCA <- tblNCA(new_metc, key = c("Period", "ID"), colTime = "RTime", colConc = "Conc", dose = 1000, adm = "Extravascular", R2ADJ = -1, concUnit = 'ng/mL') %>%
select(Period, ID, CMAX, TMAX, LAMZHL, AUCLST, AUCIFO, CLFO, VZFO)
## Create summary table
metc_NCA %>%
select(-ID) %>%
tbl_summary(by = Period,
type = TMAX ~ "continuous",
statistic = c("TMAX") ~ "{median} ({min}- {max})")
## Comparative PK(CMAX)
metc_BE_raw <- metc_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmcc <- LCMAX ~ Period  # LCMAX
BEmcc <- lme(fmcc, random = ~1|ID, data = metc_BE_raw)
cimcc <- intervals(BEmcc, 0.9)
exp(cimcc$fixed["Period2기", ])    ## 90% CI result
GLM(fmcc, metc_BE_raw)$ANOVA     ## Anova result
## Comparative PK(AUCLST)
metc_BE_raw <- metc_NCA  %>%
mutate(LCMAX = log10(CMAX), LAUCLST = log10(AUCLST))
fmca <- LAUCLST ~ Period  # LAUCLST
BEmca <- lme(fmca, random = ~1|ID, data = metc_BE_raw)
cimca <- intervals(BEmca, 0.9)
exp(cimca$fixed["Period2기", ])    ## 90% CI result
GLM(fmca, metc_BE_raw)$ANOVA     ## Anova result
